INFO 2025-04-16 09:17:34,665 [utils.py:read_activities:315] Reading ../data/raw/parakeet_austin.csv
INFO 2025-04-16 09:17:34,740 [utils.py:read_activities:326] Read 4660 activities
INFO 2025-04-16 09:17:34,743 [utils.py:read_activities:327] Will be processing between index 40 and 50
INFO 2025-04-16 09:17:34,749 [utils.py:read_activities:335] User provided the following activity columns: ['COMMODITY_DESCRIPTION']
INFO 2025-04-16 09:17:34,778 [utils.py:get_naics_data:202] Loaded 1016 rows from ../data/naics_data/SupplyChainGHGEmissionFactors_v1.2_NAICS_CO2e_USD2021.csv
INFO 2025-04-16 09:17:37,078 [utils.py:get_naics_data:211] Loaded 20082 rows from ../data/naics_data/2017_NAICS_Index_File.xlsx
INFO 2025-04-16 09:17:37,166 [utils.py:get_naics_data:214] Final shape after merge on naics_code: (19723, 5)
INFO 2025-04-16 09:17:37,179 [generate_ranked_preds.py:main:153] Number of NAICS descriptions: 19723
INFO 2025-04-16 09:17:37,182 [utils.py:get_device:89] Using MPS to calculate semantic text embedding ...
INFO 2025-04-16 09:17:51,097 [utils.py:get_cached_embedding:380] Loading cached embeddings
INFO 2025-04-16 09:17:52,833 [assistant.py:get_bedrock_client:47] Create new client
  Using region: us-east-1
INFO 2025-04-16 09:17:52,844 [assistant.py:get_bedrock_client:53]   Using profile: AdministratorAccess-237855830175
INFO 2025-04-16 09:17:53,139 [assistant.py:get_bedrock_client:81] boto3 Bedrock client successfully created!
INFO 2025-04-16 09:17:53,142 [assistant.py:get_bedrock_client:82] bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO 2025-04-16 09:17:53,150 [assistant.py:__init__:105] LCA Assistant initialized
INFO 2025-04-16 09:17:53,161 [generate_ranked_preds.py:main:204] (0/10) 1ti5TpJSw31LmkVUDn9dJw
INFO 2025-04-16 09:17:53,171 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    COUPLING PVC SCHED 40 1/2 IN
INFO 2025-04-16 09:17:58,721 [generate_ranked_preds.py:main:305] Cleaned text: A PVC (polyvinyl chloride) coupling used for connecting PVC pipes with a 1/2 inch diameter, typically used in plumbing or construction applications.
INFO 2025-04-16 09:18:01,829 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 12388, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'PVC pipe manufacturing', 'naics_code': 326122}, {'index': 4590, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}, {'index': 6831, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 13482, 'naics_title': 'Plastics Material and Resin Manufacturing', 'naics_desc': 'Polyvinyl chloride (PVC) resins manufacturing', 'naics_code': 325211}, {'index': 13147, 'naics_title': 'Iron Foundries', 'naics_desc': 'Pipe couplings, cast iron, manufacturing', 'naics_code': 331511}, {'index': 4588, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, hose, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 13154, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe fittings, rigid plastics, manufacturing', 'naics_code': 326122}, {'index': 6827, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings and unions, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 8834, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Hose couplings, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 8833, 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing', 'naics_desc': 'Hose couplings and fittings, fluid power, manufacturing', 'naics_code': 332912}, {'index': 13361, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Plumbing fittings and couplings (e.g., compression fittings, metal elbows, metal unions) manufacturing', 'naics_code': 332913}, {'index': 17108, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Supply line assemblies, plumbing (i.e., flexible hose with fittings), manufacturing', 'naics_code': 332913}, {'index': 1939, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Boiler couplings and drains, plumbing and heating-type, manufacturing', 'naics_code': 332919}, {'index': 4589, 'naics_title': 'Mechanical Power Transmission Equipment Manufacturing', 'naics_desc': 'Couplings, mechanical power transmission, manufacturing', 'naics_code': 333613}, {'index': 13173, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe, rigid plastics, manufacturing', 'naics_code': 326122}, {'index': 18955, 'naics_title': 'Plastics Material and Resin Manufacturing', 'naics_desc': 'Vinyl chloride resins manufacturing', 'naics_code': 325211}, {'index': 15447, 'naics_title': 'Adhesive Manufacturing', 'naics_desc': 'Sealing compounds for pipe threads and joints manufacturing', 'naics_code': 325520}, {'index': 4178, 'naics_title': 'Noncurrent-Carrying Wiring Device Manufacturing', 'naics_desc': 'Conduits and fittings, electrical, manufacturing', 'naics_code': 335932}, {'index': 15631, 'naics_title': 'Water and Sewer Line and Related Structures Construction', 'naics_desc': 'Sewer main, pipe and connection, construction', 'naics_code': 237110}]
INFO 2025-04-16 09:18:10,733 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 326122, 'justification': 'This NAICS code covers the manufacturing of PVC pipes and fittings, which directly aligns with the activity description of a PVC coupling used for connecting PVC pipes.', 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of pipe couplings made from purchased metal pipe, which could be relevant for some types of pipe couplings, but is less directly relevant than the PVC-specific code.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 325211, 'justification': 'This NAICS code covers the manufacturing of PVC resins, which are the raw materials used to produce PVC pipes and fittings like the coupling described.', 'naics_title': 'Plastics Material and Resin Manufacturing'}, {'naics_code': 332913, 'justification': 'This NAICS code covers the manufacturing of plumbing fittings and couplings, which could include PVC couplings used in plumbing applications.', 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing'}, {'naics_code': 332919, 'justification': 'This NAICS code covers the manufacturing of metal hose couplings, which are less directly relevant than the PVC-specific codes for the described PVC pipe coupling.', 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing'}]
INFO 2025-04-16 09:18:10,761 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:18:10,773 [generate_ranked_preds.py:main:204] (1/10) AMRaHqzMXH4gsDy7gFRxhw
INFO 2025-04-16 09:18:10,776 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    Adapters
INFO 2025-04-16 09:18:11,517 [generate_ranked_preds.py:main:305] Cleaned text: An adapter is a device used to connect or interface different components or systems.
INFO 2025-04-16 09:18:13,689 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 101, 'naics_title': 'Ammunition (except Small Arms) Manufacturing', 'naics_desc': 'Adapters, bombcluster, manufacturing', 'naics_code': 332993}, {'index': 4195, 'naics_title': 'Current-Carrying Wiring Device Manufacturing', 'naics_desc': 'Connectors and terminals for electrical devices manufacturing', 'naics_code': 335931}, {'index': 17647, 'naics_title': 'Current-Carrying Wiring Device Manufacturing', 'naics_desc': 'Terminals and connectors for electrical devices manufacturing', 'naics_code': 335931}, {'index': 4198, 'naics_title': 'Electronic Connector Manufacturing', 'naics_desc': 'Connectors, electronic (e.g., coaxial, cylindrical, printed circuit, rack and panel), manufacturing', 'naics_code': 334417}, {'index': 4200, 'naics_title': 'Switchgear and Switchboard Apparatus Manufacturing', 'naics_desc': 'Connectors, power, manufacturing', 'naics_code': 335313}, {'index': 4201, 'naics_title': 'Current-Carrying Wiring Device Manufacturing', 'naics_desc': 'Connectors, solderless (wiring devices), manufacturing', 'naics_code': 335931}, {'index': 9299, 'naics_title': 'Computer Terminal and Other Computer Peripheral Equipment Manufacturing', 'naics_desc': 'Input/output equipment, computer, manufacturing', 'naics_code': 334118}, {'index': 4589, 'naics_title': 'Mechanical Power Transmission Equipment Manufacturing', 'naics_desc': 'Couplings, mechanical power transmission, manufacturing', 'naics_code': 333613}, {'index': 4322, 'naics_title': 'Textile and Fabric Finishing Mills', 'naics_desc': 'Converters, piece goods', 'naics_code': 313310}, {'index': 14758, 'naics_title': 'Capacitor, Resistor, Coil, Transformer, and Other Inductor Manufacturing', 'naics_desc': 'Resistors, electronic, manufacturing', 'naics_code': 334416}, {'index': 6009, 'naics_title': 'Electronics Stores', 'naics_desc': 'Electronic part and component stores', 'naics_code': 443142}, {'index': 18931, 'naics_title': 'Other Gambling Industries', 'naics_desc': "Video gaming device concession operators (i.e., supplying and servicing in others' facilities)", 'naics_code': 713290}, {'index': 4199, 'naics_title': 'Other Electronic Parts and Equipment Merchant Wholesalers', 'naics_desc': 'Connectors, electronic, merchant wholesalers', 'naics_code': 423690}, {'index': 17667, 'naics_title': 'Instrument Manufacturing for Measuring and Testing Electricity and Electrical Signals', 'naics_desc': 'Test equipment for electronic and electrical circuits and equipment manufacturing', 'naics_code': 334515}, {'index': 4912, 'naics_title': 'Electronic Connector Manufacturing', 'naics_desc': 'Cylindrical connectors, electronic, manufacturing', 'naics_code': 334417}, {'index': 17242, 'naics_title': 'Switchgear and Switchboard Apparatus Manufacturing', 'naics_desc': 'Switching equipment, power, manufacturing', 'naics_code': 335313}, {'index': 4588, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, hose, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 726, 'naics_title': 'Software Publishers', 'naics_desc': 'Applications software, computer, packaged', 'naics_code': 511210}, {'index': 12333, 'naics_title': 'Current-Carrying Wiring Device Manufacturing', 'naics_desc': 'Outlets (i.e., receptacles), electrical, manufacturing', 'naics_code': 335931}, {'index': 14661, 'naics_title': 'Instrument Manufacturing for Measuring and Testing Electricity and Electrical Signals', 'naics_desc': 'Relays (except electrical, electronic), instrument, manufacturing', 'naics_code': 334515}]
INFO 2025-04-16 09:18:18,685 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 334417, 'justification': 'This NAICS code covers the manufacturing of electronic connectors, which are devices used to connect or interface different electronic components or systems.', 'naics_title': 'Electronic Connector Manufacturing'}, {'naics_code': 335931, 'justification': 'This NAICS code covers the manufacturing of current-carrying wiring devices, including connectors and terminals for electrical devices, which can be used to connect or interface different electrical components or systems.', 'naics_title': 'Current-Carrying Wiring Device Manufacturing'}, {'naics_code': 335313, 'justification': 'This NAICS code covers the manufacturing of switchgear and switchboard apparatus, including power connectors, which can be used to connect or interface different electrical components or systems.', 'naics_title': 'Switchgear and Switchboard Apparatus Manufacturing'}, {'naics_code': 333613, 'justification': 'This NAICS code covers the manufacturing of mechanical power transmission equipment, including mechanical couplings, which can be used to connect or interface different mechanical components or systems.', 'naics_title': 'Mechanical Power Transmission Equipment Manufacturing'}, {'naics_code': 334118, 'justification': 'This NAICS code covers the manufacturing of computer input/output equipment, which may include adapters or interfaces for connecting different computer components or systems.', 'naics_title': 'Computer Terminal and Other Computer Peripheral Equipment Manufacturing'}]
INFO 2025-04-16 09:18:18,789 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:18:18,794 [generate_ranked_preds.py:main:204] (2/10) 1ti5TpJSw31LmkVUDn9dJw
INFO 2025-04-16 09:18:18,797 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 09:18:18,800 [generate_ranked_preds.py:main:204] (3/10) Ol1lsXhRjMuuPTOR9S8BfA
INFO 2025-04-16 09:18:18,803 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    ADAPTER PVC SCHED 40 3/4 IN PVC TO 3/4 IN FIPT
INFO 2025-04-16 09:18:20,390 [generate_ranked_preds.py:main:305] Cleaned text: A PVC adapter fitting used to connect 3/4 inch PVC pipe to 3/4 inch female iron pipe threads.
INFO 2025-04-16 09:18:21,817 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 4590, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}, {'index': 6832, 'naics_title': 'Iron Foundries', 'naics_desc': 'Fittings, soil and pressure pipe, cast iron, manufacturing', 'naics_code': 331511}, {'index': 6831, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 13147, 'naics_title': 'Iron Foundries', 'naics_desc': 'Pipe couplings, cast iron, manufacturing', 'naics_code': 331511}, {'index': 13140, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe and pipe fittings made from purchased metal pipe', 'naics_code': 332996}, {'index': 13154, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe fittings, rigid plastics, manufacturing', 'naics_code': 326122}, {'index': 6353, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fabricated pipe and pipe fittings made from purchased pipe', 'naics_code': 332996}, {'index': 13141, 'naics_title': 'Iron Foundries', 'naics_desc': 'Pipe and pipe fittings, cast iron, manufacturing', 'naics_code': 331511}, {'index': 13151, 'naics_title': 'Plumbing, Heating, and Air-Conditioning Contractors', 'naics_desc': 'Pipe fitting contractors', 'naics_code': 238220}, {'index': 2967, 'naics_title': 'Iron Foundries', 'naics_desc': 'Cast iron pipe and pipe fittings manufacturing', 'naics_code': 331511}, {'index': 13148, 'naics_title': 'Other Building Equipment Contractors', 'naics_desc': 'Pipe covering', 'naics_code': 238290}, {'index': 13361, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Plumbing fittings and couplings (e.g., compression fittings, metal elbows, metal unions) manufacturing', 'naics_code': 332913}, {'index': 6827, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings and unions, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 12388, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'PVC pipe manufacturing', 'naics_code': 326122}, {'index': 16733, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Steam fittings, metal, manufacturing', 'naics_code': 332919}, {'index': 17108, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Supply line assemblies, plumbing (i.e., flexible hose with fittings), manufacturing', 'naics_code': 332913}, {'index': 13153, 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers', 'naics_desc': "Pipe fittings and valves, plumbers', merchant wholesalers", 'naics_code': 423720}, {'index': 13138, 'naics_title': 'Iron and Steel Pipe and Tube Manufacturing from Purchased Steel', 'naics_desc': 'Pipe (e.g., heavy riveted, lock joint, seamless, welded) made from purchased iron or steel', 'naics_code': 331210}, {'index': 6830, 'naics_title': 'Industrial Supplies Merchant Wholesalers', 'naics_desc': 'Fittings, industrial, merchant wholesalers', 'naics_code': 423840}]
INFO 2025-04-16 09:18:27,195 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 326122, 'justification': 'This NAICS code covers the manufacturing of rigid plastic pipe fittings and PVC pipe, which directly aligns with the activity description of a PVC adapter fitting for connecting PVC pipe.', 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of fabricated pipe and pipe fittings made from purchased metal pipe, which could include the iron pipe thread portion of the adapter fitting.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 331511, 'justification': 'This NAICS code covers the manufacturing of cast iron pipe and pipe fittings, which could be relevant for the iron pipe thread portion of the adapter fitting.', 'naics_title': 'Iron Foundries'}, {'naics_code': 332913, 'justification': 'This NAICS code covers the manufacturing of plumbing fittings and couplings, which could potentially include the adapter fitting for connecting PVC pipe to iron pipe threads.', 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing'}, {'naics_code': 423720, 'justification': 'This NAICS code covers the merchant wholesale of plumbing supplies, including pipe fittings and valves, which could be relevant for the distribution of the adapter fitting.', 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers'}]
INFO 2025-04-16 09:18:27,244 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:18:27,249 [generate_ranked_preds.py:main:204] (4/10) i84b4oDhP6ptQZRA6gIzWA
INFO 2025-04-16 09:18:27,253 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    NIPPLE BRASS 3/4 IN X CLOSE
INFO 2025-04-16 09:18:28,004 [generate_ranked_preds.py:main:305] Cleaned text: A brass nipple fitting with a 3/4 inch diameter used for connecting pipes or tubing.
INFO 2025-04-16 09:18:29,905 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 11871, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Nipples, metal, made from purchased pipe', 'naics_code': 332996}, {'index': 16733, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Steam fittings, metal, manufacturing', 'naics_code': 332919}, {'index': 18447, 'naics_title': 'Iron and Steel Pipe and Tube Manufacturing from Purchased Steel', 'naics_desc': 'Tubing, mechanical and hypodermic sizes, cold-drawn stainless steel, made from purchased steel', 'naics_code': 331210}, {'index': 13361, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Plumbing fittings and couplings (e.g., compression fittings, metal elbows, metal unions) manufacturing', 'naics_code': 332913}, {'index': 18446, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Tubing, flexible metal, manufacturing', 'naics_code': 332999}, {'index': 6831, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}, {'index': 4590, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 18424, 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing', 'naics_desc': 'Tube and hose fittings, fluid power, manufacturing', 'naics_code': 332912}, {'index': 8834, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Hose couplings, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 4912, 'naics_title': 'Electronic Connector Manufacturing', 'naics_desc': 'Cylindrical connectors, electronic, manufacturing', 'naics_code': 334417}, {'index': 4588, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, hose, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 16495, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Spigots, plumbing fixture fitting, manufacturing', 'naics_code': 332913}, {'index': 13140, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe and pipe fittings made from purchased metal pipe', 'naics_code': 332996}, {'index': 18448, 'naics_title': 'Metal Service Centers and Other Metal Merchant Wholesalers', 'naics_desc': 'Tubing, metal, merchant wholesalers', 'naics_code': 423510}, {'index': 8836, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Hose, flexible metal, manufacturing', 'naics_code': 332999}, {'index': 6828, 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers', 'naics_desc': "Fittings and valves, plumbers', merchant wholesalers", 'naics_code': 423720}, {'index': 13151, 'naics_title': 'Plumbing, Heating, and Air-Conditioning Contractors', 'naics_desc': 'Pipe fitting contractors', 'naics_code': 238220}, {'index': 8833, 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing', 'naics_desc': 'Hose couplings and fittings, fluid power, manufacturing', 'naics_code': 332912}, {'index': 13153, 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers', 'naics_desc': "Pipe fittings and valves, plumbers', merchant wholesalers", 'naics_code': 423720}]
INFO 2025-04-16 09:18:43,907 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of fabricated pipe and pipe fittings, including nipples and couplings made from purchased metal pipe, which directly aligns with the activity of producing a brass nipple fitting for connecting pipes or tubing.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332919, 'justification': 'This NAICS code covers the manufacturing of other metal valve and pipe fittings, including steam fittings and hose couplings, which are related to the production of pipe fittings like the brass nipple fitting.', 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing'}, {'naics_code': 332913, 'justification': 'This NAICS code covers the manufacturing of plumbing fixture fittings and trim, including plumbing fittings, couplings, and spigots, which are similar in nature to the brass nipple fitting for connecting pipes or tubing.', 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing'}, {'naics_code': 423720, 'justification': 'This NAICS code covers the merchant wholesale of plumbing and heating equipment and supplies, including pipe fittings and valves, which may be relevant for the distribution and sale of the brass nipple fitting.', 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers'}, {'naics_code': 332912, 'justification': 'This NAICS code covers the manufacturing of fluid power valve and hose fittings, including tube and hose fittings, which are related to the production of pipe fittings like the brass nipple fitting.', 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing'}]
INFO 2025-04-16 09:18:43,937 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:18:43,940 [generate_ranked_preds.py:main:204] (5/10) DOzS0YF6/hZPkh+Eo/VqLA
INFO 2025-04-16 09:18:43,948 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    COMPOUND PIPE JOINT SCREW PIPE 1/2 PT CAN
INFO 2025-04-16 09:18:45,252 [generate_ranked_preds.py:main:305] Cleaned text: A compound pipe joint screw pipe item, likely a plumbing or construction material, packaged in a 1/2 pint can.
INFO 2025-04-16 09:18:47,867 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 4590, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 15447, 'naics_title': 'Adhesive Manufacturing', 'naics_desc': 'Sealing compounds for pipe threads and joints manufacturing', 'naics_code': 325520}, {'index': 13138, 'naics_title': 'Iron and Steel Pipe and Tube Manufacturing from Purchased Steel', 'naics_desc': 'Pipe (e.g., heavy riveted, lock joint, seamless, welded) made from purchased iron or steel', 'naics_code': 331210}, {'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}, {'index': 6353, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fabricated pipe and pipe fittings made from purchased pipe', 'naics_code': 332996}, {'index': 13140, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe and pipe fittings made from purchased metal pipe', 'naics_code': 332996}, {'index': 11871, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Nipples, metal, made from purchased pipe', 'naics_code': 332996}, {'index': 13148, 'naics_title': 'Other Building Equipment Contractors', 'naics_desc': 'Pipe covering', 'naics_code': 238290}, {'index': 13159, 'naics_title': 'Other Aluminum Rolling, Drawing, and Extruding', 'naics_desc': 'Pipe made by extruding purchased aluminum', 'naics_code': 331318}, {'index': 1599, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Bends, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 13172, 'naics_title': 'Nonferrous Metal (except Copper and Aluminum) Rolling, Drawing, and Extruding', 'naics_desc': 'Pipe, nonferrous metals (except aluminum, copper), made from purchased metals or scrap', 'naics_code': 331491}, {'index': 15634, 'naics_title': 'Brick, Stone, and Related Construction Material Merchant Wholesalers', 'naics_desc': 'Sewer pipe, clay (except refractory), merchant wholesalers', 'naics_code': 423320}, {'index': 4812, 'naics_title': 'Current-Carrying Wiring Device Manufacturing', 'naics_desc': 'Current taps, attachment plug and screw shell types, manufacturing', 'naics_code': 335931}, {'index': 19620, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Wrought iron or steel pipe and tubing made from purchased metal pipe', 'naics_code': 332996}, {'index': 18615, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Unions, pipe, metal (except made from purchased pipe), manufacturing', 'naics_code': 332919}, {'index': 5890, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Elbows, pipe, metal (except made from purchased pipe), manufacturing', 'naics_code': 332919}, {'index': 4906, 'naics_title': 'Concrete Pipe Manufacturing', 'naics_desc': 'Cylinder pipe, prestressed concrete, manufacturing', 'naics_code': 327332}, {'index': 13173, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe, rigid plastics, manufacturing', 'naics_code': 326122}, {'index': 18438, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Tubes made from purchased metal pipe', 'naics_code': 332996}, {'index': 10727, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Manifolds, pipe, made from purchased metal pipe', 'naics_code': 332996}]
INFO 2025-04-16 09:19:09,586 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of fabricated pipe and pipe fittings made from purchased metal pipe, which aligns with the description of a compound pipe joint screw pipe item, likely a plumbing or construction material.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 331210, 'justification': 'This NAICS code covers the manufacturing of iron and steel pipe and tube from purchased steel, which could be relevant for the materials used in the pipe joint screw pipe item.', 'naics_title': 'Iron and Steel Pipe and Tube Manufacturing from Purchased Steel'}, {'naics_code': 325520, 'justification': 'This NAICS code covers the manufacturing of sealing compounds for pipe threads and joints, which could be relevant for the compound material used in the pipe joint screw pipe item.', 'naics_title': 'Adhesive Manufacturing'}, {'naics_code': 332919, 'justification': 'This NAICS code covers the manufacturing of other metal valve and pipe fittings, such as elbows and unions, which could be relevant for the pipe joint screw pipe item.', 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing'}, {'naics_code': 238290, 'justification': 'This NAICS code covers contractors involved in pipe covering, which could be relevant for the installation or application of the pipe joint screw pipe item in construction projects.', 'naics_title': 'Other Building Equipment Contractors'}]
INFO 2025-04-16 09:19:09,691 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:19:09,694 [generate_ranked_preds.py:main:204] (6/10) 1o30qTa40STNA2n+/2k2MQ
INFO 2025-04-16 09:19:09,696 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    NIPPLE BRASS 2 X 5 IN
INFO 2025-04-16 09:19:10,807 [generate_ranked_preds.py:main:305] Cleaned text: A brass nipple fitting with dimensions of 2 inches by 5 inches, likely used for plumbing or piping applications.
INFO 2025-04-16 09:19:12,306 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 11871, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Nipples, metal, made from purchased pipe', 'naics_code': 332996}, {'index': 16733, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Steam fittings, metal, manufacturing', 'naics_code': 332919}, {'index': 18447, 'naics_title': 'Iron and Steel Pipe and Tube Manufacturing from Purchased Steel', 'naics_desc': 'Tubing, mechanical and hypodermic sizes, cold-drawn stainless steel, made from purchased steel', 'naics_code': 331210}, {'index': 13361, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Plumbing fittings and couplings (e.g., compression fittings, metal elbows, metal unions) manufacturing', 'naics_code': 332913}, {'index': 5542, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Drain cocks, plumbing, manufacturing', 'naics_code': 332913}, {'index': 6828, 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers', 'naics_desc': "Fittings and valves, plumbers', merchant wholesalers", 'naics_code': 423720}, {'index': 16495, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Spigots, plumbing fixture fitting, manufacturing', 'naics_code': 332913}, {'index': 13366, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Plumbing fixtures, metal, manufacturing', 'naics_code': 332999}, {'index': 13153, 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers', 'naics_desc': "Pipe fittings and valves, plumbers', merchant wholesalers", 'naics_code': 423720}, {'index': 13140, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe and pipe fittings made from purchased metal pipe', 'naics_code': 332996}, {'index': 2185, 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers', 'naics_desc': "Brass goods, plumbers', merchant wholesalers", 'naics_code': 423720}, {'index': 9668, 'naics_title': 'Other Metal Container Manufacturing', 'naics_desc': 'Jugs, vacuum, light gauge metal, manufacturing', 'naics_code': 332439}, {'index': 18446, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Tubing, flexible metal, manufacturing', 'naics_code': 332999}, {'index': 3727, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Cocks, drain, plumbing, manufacturing', 'naics_code': 332913}, {'index': 8836, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Hose, flexible metal, manufacturing', 'naics_code': 332999}, {'index': 13351, 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers', 'naics_desc': "Plumbers' brass goods merchant wholesalers", 'naics_code': 423720}, {'index': 5889, 'naics_title': 'Sheet Metal Work Manufacturing', 'naics_desc': 'Elbows for conductor pipe, hot air ducts, and stovepipe, sheet metal (except stampings), manufacturing', 'naics_code': 332322}, {'index': 6831, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 16192, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Soap dispensers, metal, manufacturing', 'naics_code': 332999}, {'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}]
INFO 2025-04-16 09:19:33,759 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of metal pipe fittings, nipples, and couplings made from purchased pipe, which directly aligns with the description of a brass nipple fitting for plumbing or piping applications.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332913, 'justification': 'This NAICS code covers the manufacturing of plumbing fixture fittings, couplings, spigots, and drain cocks, which are relevant for plumbing and piping applications like the brass nipple fitting described.', 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing'}, {'naics_code': 423720, 'justification': 'This NAICS code covers the merchant wholesale of plumbing fittings, valves, and brass goods, which would include the distribution of brass nipple fittings for plumbing and piping applications.', 'naics_title': 'Plumbing and Heating Equipment and Supplies (Hydronics) Merchant Wholesalers'}, {'naics_code': 332919, 'justification': 'This NAICS code covers the manufacturing of other metal valves and pipe fittings like steam fittings, which could potentially include brass nipple fittings for plumbing or piping systems.', 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing'}, {'naics_code': 332999, 'justification': 'This catch-all NAICS code for miscellaneous fabricated metal products covers the manufacturing of plumbing fixtures and flexible metal tubing, which could potentially include brass nipple fittings for plumbing applications.', 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing'}]
INFO 2025-04-16 09:19:33,827 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:19:33,833 [generate_ranked_preds.py:main:204] (7/10) GqkNlm6l9Lwh/ztNAfXPpg
INFO 2025-04-16 09:19:33,836 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    COUPLING BRASS COMP GJ X COMP GJ 1-1/4 IN
INFO 2025-04-16 09:19:35,991 [generate_ranked_preds.py:main:305] Cleaned text: A brass coupling used to connect two pipes or tubes with a diameter of 1-1/4 inches.
INFO 2025-04-16 09:19:38,652 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 4590, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}, {'index': 8834, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Hose couplings, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 4588, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, hose, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 13147, 'naics_title': 'Iron Foundries', 'naics_desc': 'Pipe couplings, cast iron, manufacturing', 'naics_code': 331511}, {'index': 13361, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Plumbing fittings and couplings (e.g., compression fittings, metal elbows, metal unions) manufacturing', 'naics_code': 332913}, {'index': 8833, 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing', 'naics_desc': 'Hose couplings and fittings, fluid power, manufacturing', 'naics_code': 332912}, {'index': 4589, 'naics_title': 'Mechanical Power Transmission Equipment Manufacturing', 'naics_desc': 'Couplings, mechanical power transmission, manufacturing', 'naics_code': 333613}, {'index': 1939, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Boiler couplings and drains, plumbing and heating-type, manufacturing', 'naics_code': 332919}, {'index': 16733, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Steam fittings, metal, manufacturing', 'naics_code': 332919}, {'index': 4912, 'naics_title': 'Electronic Connector Manufacturing', 'naics_desc': 'Cylindrical connectors, electronic, manufacturing', 'naics_code': 334417}, {'index': 13140, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe and pipe fittings made from purchased metal pipe', 'naics_code': 332996}, {'index': 6860, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Flanges and flange unions, pipe, metal, manufacturing', 'naics_code': 332919}, {'index': 18424, 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing', 'naics_desc': 'Tube and hose fittings, fluid power, manufacturing', 'naics_code': 332912}, {'index': 5889, 'naics_title': 'Sheet Metal Work Manufacturing', 'naics_desc': 'Elbows for conductor pipe, hot air ducts, and stovepipe, sheet metal (except stampings), manufacturing', 'naics_code': 332322}, {'index': 8836, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Hose, flexible metal, manufacturing', 'naics_code': 332999}, {'index': 18447, 'naics_title': 'Iron and Steel Pipe and Tube Manufacturing from Purchased Steel', 'naics_desc': 'Tubing, mechanical and hypodermic sizes, cold-drawn stainless steel, made from purchased steel', 'naics_code': 331210}, {'index': 18446, 'naics_title': 'All Other Miscellaneous Fabricated Metal Product Manufacturing', 'naics_desc': 'Tubing, flexible metal, manufacturing', 'naics_code': 332999}, {'index': 13151, 'naics_title': 'Plumbing, Heating, and Air-Conditioning Contractors', 'naics_desc': 'Pipe fitting contractors', 'naics_code': 238220}, {'index': 18438, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Tubes made from purchased metal pipe', 'naics_code': 332996}]
INFO 2025-04-16 09:19:52,507 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of fabricated pipe and pipe fittings, including couplings made from purchased metal pipe, which directly aligns with the activity description of a brass coupling used to connect pipes.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332919, 'justification': 'This NAICS code covers the manufacturing of other metal valve and pipe fittings, including hose couplings and steam fittings, which are relevant for connecting pipes and tubes.', 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing'}, {'naics_code': 331511, 'justification': 'This NAICS code covers the manufacturing of cast iron pipe couplings, which could be relevant for the brass coupling activity.', 'naics_title': 'Iron Foundries'}, {'naics_code': 332913, 'justification': 'This NAICS code covers the manufacturing of plumbing fittings and couplings, which could be relevant for the brass coupling used to connect pipes.', 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing'}, {'naics_code': 332912, 'justification': 'This NAICS code covers the manufacturing of fluid power hose fittings and couplings, which could be relevant for the brass coupling activity, although less directly related than the other codes.', 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing'}]
INFO 2025-04-16 09:19:52,566 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:19:52,572 [generate_ranked_preds.py:main:204] (8/10) 5VULxBJI1qyGuoJSM8qOcg
INFO 2025-04-16 09:19:52,579 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    COUPLING PVC SCHED 40 3/4 IN
INFO 2025-04-16 09:20:00,243 [generate_ranked_preds.py:main:305] Cleaned text: A 3/4 inch PVC schedule 40 pipe coupling used for joining PVC pipes.
INFO 2025-04-16 09:20:03,182 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}, {'index': 4590, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 13147, 'naics_title': 'Iron Foundries', 'naics_desc': 'Pipe couplings, cast iron, manufacturing', 'naics_code': 331511}, {'index': 12388, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'PVC pipe manufacturing', 'naics_code': 326122}, {'index': 6831, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 13361, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Plumbing fittings and couplings (e.g., compression fittings, metal elbows, metal unions) manufacturing', 'naics_code': 332913}, {'index': 6827, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings and unions, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 13154, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe fittings, rigid plastics, manufacturing', 'naics_code': 326122}, {'index': 8834, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Hose couplings, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 4588, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, hose, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 8833, 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing', 'naics_desc': 'Hose couplings and fittings, fluid power, manufacturing', 'naics_code': 332912}, {'index': 4589, 'naics_title': 'Mechanical Power Transmission Equipment Manufacturing', 'naics_desc': 'Couplings, mechanical power transmission, manufacturing', 'naics_code': 333613}, {'index': 13151, 'naics_title': 'Plumbing, Heating, and Air-Conditioning Contractors', 'naics_desc': 'Pipe fitting contractors', 'naics_code': 238220}, {'index': 13148, 'naics_title': 'Other Building Equipment Contractors', 'naics_desc': 'Pipe covering', 'naics_code': 238290}, {'index': 1939, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Boiler couplings and drains, plumbing and heating-type, manufacturing', 'naics_code': 332919}, {'index': 6353, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fabricated pipe and pipe fittings made from purchased pipe', 'naics_code': 332996}, {'index': 15447, 'naics_title': 'Adhesive Manufacturing', 'naics_desc': 'Sealing compounds for pipe threads and joints manufacturing', 'naics_code': 325520}, {'index': 6832, 'naics_title': 'Iron Foundries', 'naics_desc': 'Fittings, soil and pressure pipe, cast iron, manufacturing', 'naics_code': 331511}, {'index': 15631, 'naics_title': 'Water and Sewer Line and Related Structures Construction', 'naics_desc': 'Sewer main, pipe and connection, construction', 'naics_code': 237110}, {'index': 15632, 'naics_title': 'Clay Building Material and Refractories Manufacturing', 'naics_desc': 'Sewer pipe and fittings, clay, manufacturing', 'naics_code': 327120}]
INFO 2025-04-16 09:20:17,241 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 326122, 'justification': 'This NAICS code covers the manufacturing of PVC pipe and pipe fittings, which directly aligns with the activity description of a PVC pipe coupling.', 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of fabricated pipe and pipe fittings made from purchased metal pipe, which could be relevant for metal pipe couplings but is less directly relevant than the plastics pipe and fitting manufacturing code for a PVC coupling.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 331511, 'justification': 'This NAICS code covers the manufacturing of cast iron pipe couplings, which could be relevant for certain types of pipe couplings but is less directly relevant than the plastics pipe and fitting manufacturing code for a PVC coupling.', 'naics_title': 'Iron Foundries'}, {'naics_code': 332913, 'justification': 'This NAICS code covers the manufacturing of plumbing fittings and couplings, which could be relevant for certain types of pipe couplings but is less directly relevant than the plastics pipe and fitting manufacturing code for a PVC coupling.', 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing'}, {'naics_code': 332919, 'justification': 'This NAICS code covers the manufacturing of metal hose couplings and other metal valve and pipe fittings, which could be relevant for certain types of pipe couplings but is less directly relevant than the plastics pipe and fitting manufacturing code for a PVC coupling.', 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing'}]
INFO 2025-04-16 09:20:17,338 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 09:20:17,342 [generate_ranked_preds.py:main:204] (9/10) gmbEsZGu69Jv8r/PhAAScw
INFO 2025-04-16 09:20:17,344 [generate_ranked_preds.py:main:296] Item description:
COMMODITY_DESCRIPTION    COUPLING, PVC, SCHED- 40, EXPANDABLE REPAIR 3/4 INCH
INFO 2025-04-16 09:20:22,484 [generate_ranked_preds.py:main:305] Cleaned text: A PVC coupling used for repairing or connecting 3/4 inch schedule 40 PVC pipes.
INFO 2025-04-16 09:20:24,418 [generate_ranked_preds.py:main:317] Top 20 NAICS: [{'index': 4590, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, pipe, made from purchased metal pipe', 'naics_code': 332996}, {'index': 13146, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe couplings made from purchased metal pipe', 'naics_code': 332996}, {'index': 13147, 'naics_title': 'Iron Foundries', 'naics_desc': 'Pipe couplings, cast iron, manufacturing', 'naics_code': 331511}, {'index': 4588, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Couplings, hose, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 12388, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'PVC pipe manufacturing', 'naics_code': 326122}, {'index': 8834, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Hose couplings, metal (except fluid power), manufacturing', 'naics_code': 332919}, {'index': 8833, 'naics_title': 'Fluid Power Valve and Hose Fitting Manufacturing', 'naics_desc': 'Hose couplings and fittings, fluid power, manufacturing', 'naics_code': 332912}, {'index': 13361, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Plumbing fittings and couplings (e.g., compression fittings, metal elbows, metal unions) manufacturing', 'naics_code': 332913}, {'index': 6831, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 4589, 'naics_title': 'Mechanical Power Transmission Equipment Manufacturing', 'naics_desc': 'Couplings, mechanical power transmission, manufacturing', 'naics_code': 333613}, {'index': 6827, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fittings and unions, rigid plastics pipe, manufacturing', 'naics_code': 326122}, {'index': 1939, 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing', 'naics_desc': 'Boiler couplings and drains, plumbing and heating-type, manufacturing', 'naics_code': 332919}, {'index': 13154, 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Pipe fittings, rigid plastics, manufacturing', 'naics_code': 326122}, {'index': 13148, 'naics_title': 'Other Building Equipment Contractors', 'naics_desc': 'Pipe covering', 'naics_code': 238290}, {'index': 6353, 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing', 'naics_desc': 'Fabricated pipe and pipe fittings made from purchased pipe', 'naics_code': 332996}, {'index': 17108, 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing', 'naics_desc': 'Supply line assemblies, plumbing (i.e., flexible hose with fittings), manufacturing', 'naics_code': 332913}, {'index': 15631, 'naics_title': 'Water and Sewer Line and Related Structures Construction', 'naics_desc': 'Sewer main, pipe and connection, construction', 'naics_code': 237110}, {'index': 15447, 'naics_title': 'Adhesive Manufacturing', 'naics_desc': 'Sealing compounds for pipe threads and joints manufacturing', 'naics_code': 325520}, {'index': 4178, 'naics_title': 'Noncurrent-Carrying Wiring Device Manufacturing', 'naics_desc': 'Conduits and fittings, electrical, manufacturing', 'naics_code': 335932}, {'index': 13151, 'naics_title': 'Plumbing, Heating, and Air-Conditioning Contractors', 'naics_desc': 'Pipe fitting contractors', 'naics_code': 238220}]
INFO 2025-04-16 09:20:44,828 [generate_ranked_preds.py:main:325] LLM re-ranked (5): [{'naics_code': 326122, 'justification': 'This NAICS code covers the manufacturing of PVC pipe fittings and couplings, which directly aligns with the activity description of a PVC coupling for PVC pipes.', 'naics_title': 'Plastics Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332996, 'justification': 'This NAICS code covers the manufacturing of fabricated pipe fittings and couplings made from purchased metal pipe, which could be relevant for PVC pipe couplings.', 'naics_title': 'Fabricated Pipe and Pipe Fitting Manufacturing'}, {'naics_code': 332913, 'justification': 'This NAICS code covers the manufacturing of plumbing fittings and couplings, which could include PVC pipe couplings used in plumbing applications.', 'naics_title': 'Plumbing Fixture Fitting and Trim Manufacturing'}, {'naics_code': 332919, 'justification': 'This NAICS code covers the manufacturing of metal hose couplings and other metal pipe fittings, which could potentially include PVC pipe couplings.', 'naics_title': 'Other Metal Valve and Pipe Fitting Manufacturing'}, {'naics_code': 331511, 'justification': 'This NAICS code covers the manufacturing of cast iron pipe couplings, which could be relevant for PVC pipe couplings used in certain applications.', 'naics_title': 'Iron Foundries'}]
INFO 2025-04-16 09:20:44,847 [generate_ranked_preds.py:main:371] ------------------------------------------------------------------------------------------------
INFO 2025-04-16 17:23:48,803 [utils.py:read_activities:315] Reading ../data/raw/parakeet_austin.csv
INFO 2025-04-16 17:23:48,899 [utils.py:read_activities:326] Read 4660 activities
INFO 2025-04-16 17:23:48,908 [utils.py:read_activities:327] Will be processing between index 40 and 50
INFO 2025-04-16 17:23:48,917 [utils.py:read_activities:335] User provided the following activity columns: ['COMMODITY_DESCRIPTION']
INFO 2025-04-16 17:23:48,942 [utils.py:get_naics_data:202] Loaded 1016 rows from ../data/naics_data/SupplyChainGHGEmissionFactors_v1.2_NAICS_CO2e_USD2021.csv
INFO 2025-04-16 17:23:53,340 [utils.py:get_naics_data:211] Loaded 20082 rows from ../data/naics_data/2017_NAICS_Index_File.xlsx
INFO 2025-04-16 17:23:53,491 [utils.py:get_naics_data:214] Final shape after merge on naics_code: (19723, 5)
INFO 2025-04-16 17:23:53,519 [generate_ranked_preds.py:main:153] Number of NAICS descriptions: 19723
INFO 2025-04-16 17:23:53,528 [utils.py:get_device:89] Using MPS to calculate semantic text embedding ...
INFO 2025-04-16 17:24:09,664 [utils.py:get_cached_embedding:380] Loading cached embeddings
INFO 2025-04-16 17:24:11,924 [assistant.py:get_bedrock_client:47] Create new client
  Using region: us-east-1
INFO 2025-04-16 17:24:11,937 [assistant.py:get_bedrock_client:53]   Using profile: AdministratorAccess-237855830175
INFO 2025-04-16 17:24:12,220 [assistant.py:get_bedrock_client:81] boto3 Bedrock client successfully created!
INFO 2025-04-16 17:24:12,223 [assistant.py:get_bedrock_client:82] bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO 2025-04-16 17:24:12,226 [assistant.py:__init__:105] LCA Assistant initialized
INFO 2025-04-16 17:24:12,258 [generate_ranked_preds.py:main:204] (0/10) 1ti5TpJSw31LmkVUDn9dJw
INFO 2025-04-16 17:24:12,263 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,266 [generate_ranked_preds.py:main:204] (1/10) AMRaHqzMXH4gsDy7gFRxhw
INFO 2025-04-16 17:24:12,268 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,274 [generate_ranked_preds.py:main:204] (2/10) 1ti5TpJSw31LmkVUDn9dJw
INFO 2025-04-16 17:24:12,277 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,289 [generate_ranked_preds.py:main:204] (3/10) Ol1lsXhRjMuuPTOR9S8BfA
INFO 2025-04-16 17:24:12,294 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,296 [generate_ranked_preds.py:main:204] (4/10) i84b4oDhP6ptQZRA6gIzWA
INFO 2025-04-16 17:24:12,299 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,304 [generate_ranked_preds.py:main:204] (5/10) DOzS0YF6/hZPkh+Eo/VqLA
INFO 2025-04-16 17:24:12,310 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,313 [generate_ranked_preds.py:main:204] (6/10) 1o30qTa40STNA2n+/2k2MQ
INFO 2025-04-16 17:24:12,316 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,318 [generate_ranked_preds.py:main:204] (7/10) GqkNlm6l9Lwh/ztNAfXPpg
INFO 2025-04-16 17:24:12,321 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,324 [generate_ranked_preds.py:main:204] (8/10) 5VULxBJI1qyGuoJSM8qOcg
INFO 2025-04-16 17:24:12,327 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-16 17:24:12,330 [generate_ranked_preds.py:main:204] (9/10) gmbEsZGu69Jv8r/PhAAScw
INFO 2025-04-16 17:24:12,333 [generate_ranked_preds.py:main:206] Skipping already processed activity
INFO 2025-04-17 21:52:38,157 [utils.py:read_activities:315] Reading ../data/raw/parakeet_austin.csv
INFO 2025-04-17 21:52:38,254 [utils.py:read_activities:326] Read 4660 activities
INFO 2025-04-17 21:52:38,256 [utils.py:read_activities:327] Will be processing between index 40 and 50
INFO 2025-04-17 21:52:38,259 [utils.py:read_activities:335] User provided the following activity columns: ['COMMODITY_DESCRIPTION']
INFO 2025-04-17 21:52:38,296 [utils.py:get_naics_data:202] Loaded 1016 rows from ../data/naics_data/SupplyChainGHGEmissionFactors_v1.2_NAICS_CO2e_USD2021.csv
INFO 2025-04-17 21:52:41,877 [utils.py:get_naics_data:211] Loaded 20082 rows from ../data/naics_data/2017_NAICS_Index_File.xlsx
INFO 2025-04-17 21:52:42,001 [utils.py:get_naics_data:214] Final shape after merge on naics_code: (19723, 5)
INFO 2025-04-17 21:52:42,013 [generate_ranked_preds.py:main:168] Number of NAICS descriptions: 19723
INFO 2025-04-17 21:52:42,016 [utils.py:get_device:89] Using MPS to calculate semantic text embedding ...
INFO 2025-04-17 21:52:55,969 [utils.py:get_cached_embedding:380] Loading cached embeddings
INFO 2025-04-17 21:52:57,972 [assistant.py:get_bedrock_client:47] Create new client
  Using region: us-east-1
INFO 2025-04-17 21:52:57,981 [assistant.py:get_bedrock_client:53]   Using profile: AdministratorAccess-237855830175
INFO 2025-04-17 21:52:58,335 [assistant.py:get_bedrock_client:81] boto3 Bedrock client successfully created!
INFO 2025-04-17 21:52:58,344 [assistant.py:get_bedrock_client:82] bedrock-runtime(https://bedrock-runtime.us-east-1.amazonaws.com)
INFO 2025-04-17 21:52:58,348 [assistant.py:__init__:105] LCA Assistant initialized
INFO 2025-04-17 21:52:58,374 [generate_ranked_preds.py:main:219] (0/10) 1ti5TpJSw31LmkVUDn9dJw
INFO 2025-04-17 21:52:58,382 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,385 [generate_ranked_preds.py:main:219] (1/10) AMRaHqzMXH4gsDy7gFRxhw
INFO 2025-04-17 21:52:58,388 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,390 [generate_ranked_preds.py:main:219] (2/10) 1ti5TpJSw31LmkVUDn9dJw
INFO 2025-04-17 21:52:58,392 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,394 [generate_ranked_preds.py:main:219] (3/10) Ol1lsXhRjMuuPTOR9S8BfA
INFO 2025-04-17 21:52:58,397 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,399 [generate_ranked_preds.py:main:219] (4/10) i84b4oDhP6ptQZRA6gIzWA
INFO 2025-04-17 21:52:58,401 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,403 [generate_ranked_preds.py:main:219] (5/10) DOzS0YF6/hZPkh+Eo/VqLA
INFO 2025-04-17 21:52:58,405 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,407 [generate_ranked_preds.py:main:219] (6/10) 1o30qTa40STNA2n+/2k2MQ
INFO 2025-04-17 21:52:58,413 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,415 [generate_ranked_preds.py:main:219] (7/10) GqkNlm6l9Lwh/ztNAfXPpg
INFO 2025-04-17 21:52:58,419 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,426 [generate_ranked_preds.py:main:219] (8/10) 5VULxBJI1qyGuoJSM8qOcg
INFO 2025-04-17 21:52:58,429 [generate_ranked_preds.py:main:221] Skipping already processed activity
INFO 2025-04-17 21:52:58,441 [generate_ranked_preds.py:main:219] (9/10) gmbEsZGu69Jv8r/PhAAScw
INFO 2025-04-17 21:52:58,447 [generate_ranked_preds.py:main:221] Skipping already processed activity
